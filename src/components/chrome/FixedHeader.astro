---
/**
 * FixedHeader Component
 *
 * Fixed header that appears when hero wordmark scrolls out of view.
 * Contains wordmark, navigation, and theme switcher.
 */

import {NAV_LINKS} from "../../config/navigation";

import {LogoMark, Nav} from "../navigation";
import {ThemeSwitcher} from "../theme";
---

<header
  id="fixed-header"
  class="fixed-header"
  transition:persist
  transition:name="header"
>
  <div class="fixed-header-inner">
    <div class="fixed-header-left">
      <LogoMark href="/" label="Go to home" onClick="scrollToTop" />
      <Nav links={NAV_LINKS} aria-label="Main navigation" />
    </div>
    <div class="fixed-header-right">
      <ThemeSwitcher size="sm" />
    </div>
  </div>
</header>

<style>
  .fixed-header {
    position: fixed;
    top: var(--safe-area-top);
    left: 0;
    right: 0;
    z-index: var(--z-header);
    background: var(--bg);

    /* Hidden by default */
    opacity: 0;
    transform: translateY(-100%);
    pointer-events: none;
    transition:
      background var(--transition-slow),
      color var(--transition-slow),
      opacity var(--transition-slow),
      transform var(--transition-slow);
  }

  .fixed-header.visible {
    opacity: 1;
    transform: translateY(0);
    pointer-events: auto;
  }

  .fixed-header-inner {
    max-width: var(--container-max);
    margin: 0 auto;
    padding: var(--space-4) var(--container-px);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .fixed-header-left {
    display: flex;
    align-items: center;
    gap: var(--space-6);
  }

  .fixed-header-right {
    display: flex;
    align-items: center;
  }

  @media (prefers-reduced-motion: reduce) {
    .fixed-header {
      transition: none;
    }
  }
</style>

<script>
  const initScrollToTop = () => {
    const logomark = document.querySelector(
      '.logomark[data-onclick="scrollToTop"]'
    );

    logomark?.addEventListener("click", (e) => {
      if (window.location.pathname === "/") {
        e.preventDefault();
        window.scrollTo({top: 0, behavior: "smooth"});
      }
    });
  };

  initScrollToTop();
  document.addEventListener("astro:after-swap", initScrollToTop);
</script>
