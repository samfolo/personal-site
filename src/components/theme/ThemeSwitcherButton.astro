---
/**
 * ThemeSwitcherButton Component
 *
 * Reusable theme button with diagonal colour preview.
 * Used by ThemeSwitcher for both desktop buttons and mobile toggle.
 *
 * Sizing Note:
 * Button size is controlled via the --theme-switcher-size CSS custom property,
 * which can be set by parent components. This enables smooth size transitions
 * when the property changes (e.g., in SiteHeader state changes).
 * Defaults to --size-7 (32px) if not set.
 */

import type {Theme} from "../../config/themes";

/**
 * Props for the ThemeSwitcherButton component.
 */
interface Props {
  /**
   * Theme to preview. If omitted, shows current theme colours.
   */
  theme?: Theme;

  /**
   * Whether outline is always visible (not just on focus).
   */
  isActive?: boolean;

  /**
   * Accessible label for the button.
   */
  label: string;

  /**
   * Additional CSS classes.
   */
  class?: string;
}

const {theme, isActive = false, label, class: className} = Astro.props;
---

<button
  type="button"
  class:list={["theme-switcher-button", theme && `theme-${theme}`, className]}
  data-theme={theme}
  data-active={isActive}
  aria-label={label}
>
  <span class="theme-switcher-button-visual"></span>
</button>

<style>
  .theme-switcher-button {
    display: flex;
    align-items: center;
    justify-content: center;
    width: var(--theme-switcher-size, var(--size-7));
    height: var(--theme-switcher-size, var(--size-7));
    cursor: pointer;
    transition:
      transform var(--transition-fast),
      width var(--transition-slow),
      height var(--transition-slow);
    outline: var(--outline-width) solid transparent;
    outline-offset: var(--outline-offset-tight);
    background: transparent;
    border: none;
    padding: 0;
  }

  .theme-switcher-button-visual {
    display: block;
    width: 100%;
    height: 100%;
    border: var(--border-thin) solid var(--fg);
    background: linear-gradient(135deg, var(--bg) 50%, var(--fg) 50%);
  }

  .theme-switcher-button:hover {
    transform: scale(1.1);
  }

  .theme-switcher-button:focus-visible {
    outline: var(--outline-width) solid var(--fg);
  }

  .theme-switcher-button[data-active="true"] {
    outline: var(--outline-width) solid var(--fg);
  }

  @media (prefers-reduced-motion: reduce) {
    .theme-switcher-button {
      transition: none !important;
    }
  }
</style>
