---
/**
 * Post Layout
 *
 * Layout for individual blog posts.
 * Displays title, metadata, content, and post navigation.
 */

import type {CollectionEntry} from "astro:content";

import JSONLD from "../components/JSONLD.astro";
import PostMeta from "../components/PostMeta.astro";
import PostNav from "../components/PostNav.astro";
import PostTags from "../components/PostTags.astro";
import {MEDIUM_SHEEN} from "../config/sheen";
import {getBlogPostOgPath} from "../lib/og";

import Prose from "./Prose.astro";

interface PostNavLink {
  slug: string;
  title: string;
}

interface Props {
  post: CollectionEntry<"blog">;
  readingTime: string;
  prevPost?: PostNavLink | null;
  nextPost?: PostNavLink | null;
}

const {post, readingTime, prevPost, nextPost} = Astro.props;
const {title, description, publishDate, updatedDate, tags} = post.data;
---

<Prose
  title={`${title} | Sam Folorunsho`}
  description={description}
  heading={title}
  seo={{
    ogImage: getBlogPostOgPath(post.id),
    ogType: "article",
    publishDate,
    updatedDate,
    tags,
  }}
  sheenConfig={MEDIUM_SHEEN}
  headingId="post-title"
>
  <JSONLD
    type="Article"
    article={{
      headline: title,
      description,
      publishDate,
      updatedDate,
      tags,
    }}
  />

  <Fragment slot="meta">
    <PostMeta {publishDate} {updatedDate} {readingTime} />
    <PostTags {tags} />
  </Fragment>

  <slot />

  <PostNav slot="after" {prevPost} {nextPost} />
</Prose>

<script>
  import "../scripts/code-copy.ts";
  import "../scripts/heading-anchors.ts";
  import "../scripts/sheen-headings.ts";
  import "../scripts/sheen-links.ts";
</script>
