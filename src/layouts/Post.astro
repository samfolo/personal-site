---
/**
 * Post Layout
 *
 * Layout for individual blog posts.
 * Displays title, metadata, content, and post navigation.
 */

import type {CollectionEntry} from "astro:content";

import type {PostNavLink} from "../components/blog";
import {PostMeta, PostNav, PostTags} from "../components/blog";
import {JSONLD} from "../components/seo";
import {MEDIUM_SHEEN} from "../config/sheen";
import {getBlogPostOgPath} from "../lib/og";

import Prose from "./Prose.astro";

/**
 * Props for the Post layout.
 */
interface Props {
  /**
   * Blog post entry from the content collection.
   */
  post: CollectionEntry<"blog">;

  /**
   * Formatted reading time string.
   */
  readingTime: string;

  /**
   * Link to the previous post, if any.
   */
  prevPost?: PostNavLink | null;

  /**
   * Link to the next post, if any.
   */
  nextPost?: PostNavLink | null;
}

const {post, readingTime, prevPost, nextPost} = Astro.props;
const {title, description, publishDate, updatedDate, tags} = post.data;
---

<Prose
  title={`${title} | Sam Folorunsho`}
  description={description}
  heading={title}
  seo={{
    ogImage: getBlogPostOgPath(post.id),
    ogType: "article",
    publishDate,
    updatedDate,
    tags,
  }}
  sheenConfig={MEDIUM_SHEEN}
  headingId="post-title"
>
  <JSONLD
    slot="head"
    type="BlogPosting"
    article={{
      headline: title,
      description,
      publishDate,
      updatedDate,
      tags,
    }}
  />

  <Fragment slot="meta">
    <PostMeta {publishDate} {updatedDate} {readingTime} />
    <PostTags {tags} />
  </Fragment>

  <slot />

  <PostNav slot="after" {prevPost} {nextPost} />
</Prose>

<script>
  import "../scripts/code-copy.ts";
  import "../scripts/heading-anchors.ts";
  import "../scripts/sheen/headings.ts";
  import "../scripts/sheen/links.ts";
</script>
