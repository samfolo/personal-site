/**
 * Prose Typography Styles
 *
 * Customises @tailwindcss/typography with design tokens.
 * Applied to blog post content.
 */

@layer components {
  .prose {
    /* Map to design tokens */
    --tw-prose-body: var(--fg);
    --tw-prose-headings: var(--fg);
    --tw-prose-lead: var(--muted);
    --tw-prose-links: var(--fg);
    --tw-prose-bold: var(--fg);
    --tw-prose-counters: var(--muted);
    --tw-prose-bullets: var(--muted);
    --tw-prose-hr: var(--rule);
    --tw-prose-quotes: var(--fg);
    --tw-prose-quote-borders: var(--rule);
    --tw-prose-captions: var(--muted);
    --tw-prose-code: var(--fg);
    --tw-prose-pre-code: var(--fg);
    --tw-prose-pre-bg: var(--rule);
    --tw-prose-th-borders: var(--rule);
    --tw-prose-td-borders: var(--rule);

    /* Typography settings */
    font-size: var(--text-base);
    line-height: var(--leading-relaxed);
    max-width: none;
  }

  /* Heading styles */
  .prose :where(h1):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    font-size: var(--text-xl);
    font-weight: var(--font-bold);
    letter-spacing: var(--tracking-display);
    line-height: var(--leading-tight);
    margin-top: var(--space-8);
    margin-bottom: var(--space-4);
  }

  .prose :where(h2):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    font-size: var(--text-lg);
    font-weight: var(--font-bold);
    letter-spacing: var(--tracking-display);
    line-height: var(--leading-tight);
    margin-top: var(--space-8);
    margin-bottom: var(--space-4);
  }

  .prose :where(h3):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    font-size: var(--text-md);
    font-weight: var(--font-semibold);
    line-height: var(--leading-snug);
    margin-top: var(--space-6);
    margin-bottom: var(--space-3);
  }

  /* Heading anchor links */
  .prose :where(h2, h3):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    position: relative;
  }

  .prose :where(.heading-anchor):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    position: absolute;
    left: calc(-1 * var(--space-5));
    font-weight: var(--font-regular);
    color: var(--muted);
    opacity: 0;
    text-decoration: none;
    transition: opacity var(--transition-fast), color var(--transition-fast);
  }

  .prose :where(h2:hover .heading-anchor, h3:hover .heading-anchor):not(:where([class~="not-prose"], [class~="not-prose"] *)),
  .prose :where(.heading-anchor:focus):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    opacity: 1;
  }

  .prose :where(.heading-anchor:hover):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    color: var(--fg);
  }

  /* Paragraph spacing */
  .prose :where(p):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    margin-top: var(--space-4);
    margin-bottom: var(--space-5);
  }

  /* First paragraph after heading - tighter spacing */
  .prose :where(h1 + p, h2 + p, h3 + p):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    margin-top: 0;
  }

  /* Link underline on hover */
  .prose :where(a):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    text-decoration: underline;
    text-decoration-color: var(--rule);
    text-underline-offset: 3px;
    transition: text-decoration-color var(--transition-fast);
  }

  .prose :where(a):not(:where([class~="not-prose"], [class~="not-prose"] *)):hover {
    text-decoration-color: var(--fg);
  }

  /* Code blocks */
  .prose :where(code):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    font-family: var(--font-mono);
    font-size: var(--text-sm);
    background-color: var(--rule);
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
  }

  .prose :where(code):not(:where([class~="not-prose"], [class~="not-prose"] *))::before,
  .prose :where(code):not(:where([class~="not-prose"], [class~="not-prose"] *))::after {
    content: none;
  }

  .prose :where(pre):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    font-family: var(--font-mono);
    font-size: var(--text-sm);
    line-height: var(--leading-normal);
    padding: var(--space-5);
    border-radius: var(--space-2);
    margin-top: var(--space-5);
    margin-bottom: var(--space-5);
    overflow-x: auto;
  }

  .prose :where(pre code):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    background-color: transparent;
    padding: 0;
  }

  /* Blockquotes */
  .prose :where(blockquote):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    font-style: italic;
    border-left-width: var(--border-thin);
    border-left-color: var(--rule);
    padding-left: var(--space-4);
    margin-top: var(--space-5);
    margin-bottom: var(--space-5);
  }

  /* Lists */
  .prose :where(ul, ol):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    padding-left: var(--space-5);
    margin-top: var(--space-4);
    margin-bottom: var(--space-5);
  }

  .prose :where(ul):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    list-style-type: disc;
  }

  .prose :where(ol):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    list-style-type: decimal;
  }

  .prose :where(li):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    margin-top: var(--space-2);
    margin-bottom: var(--space-2);
  }

  /* Horizontal rules */
  .prose :where(hr):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    border-color: var(--rule);
    margin-top: var(--space-7);
    margin-bottom: var(--space-7);
  }

  /* Images */
  .prose :where(img):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    margin-top: var(--space-6);
    margin-bottom: var(--space-6);
    border-radius: var(--space-2);
  }

  /* Strong text */
  .prose :where(strong):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    font-weight: var(--font-semibold);
  }
}
